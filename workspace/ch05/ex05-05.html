<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="todo">
      <header>
        <h1>Todo List - ëª©ë¡ ì¡°íšŒğŸ˜Š</h1>
      </header>
      <div id="main">
        <div id="container">
          <ul>
            <li>
              <h2>ì‡¼í•‘ ëª©ë¡</h2>
              <div class="todoinput">
                <input type="text" autofocus onkeyup="handlekeyup(event)" />
                <button type="button" onclick="handleAdd()">ì¶”ê°€</button>
              </div>
              <ul class="todolist">
                <!-- <li data-no="1">
                  <span>1</span>
                  <span><s>ìƒ˜í”Œ1</s></span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="2">
                  <span>2</span>
                  <span>ìƒ˜í”Œ2</span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="3">
                  <span>3</span>
                  <span>ìƒ˜í”Œ3</span>
                  <button type="button">ì‚­ì œ</button>
                </li> -->
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <footer>
        <p>ë©‹ìŸì´ ì‚¬ìì²˜ëŸ¼ FrontEnd BootCamp</p>
      </footer>
    </div>

    <script>
      //í•œê±´ì˜ Todo ê°ì²´ë¥¼ ë°›ì•„ì„œ DOM ê°ì²´ë¡œ ë§Œë“¤ì–´ ë°˜í™˜
      function getTodoItemElem(item) {
        // { no: 3, title:'ë¼ë©´', done: true} // Todo ê°ì²´
        /* DOM ê°ì²´
              <li>
                <span>3</span>
                <span>ìƒ˜í”Œ3</span>
                <button type="button">ì‚­ì œ</button>
              </li>; */

        //ğŸ“Œ íƒœê·¸ ìƒì„±
        //<li>
        const liElem = document.createElement("li");
        //ë²ˆí˜¸<span>
        const noElem = document.createElement("span");
        //ì´ë¦„<span>
        const titleElem = document.createElement("span");
        //ì‚­ì œ<button>
        const deleteElem = document.createElement("button");

        //ğŸ“Œ í…ìŠ¤íŠ¸ ìƒì„±
        //3
        const noTxt = document.createTextNode(item.no);
        //ìƒ˜í’€ 3
        const titleTxt = document.createTextNode(item.title);
        //ì‚­ì œ
        const deleteTxt = document.createTextNode("ì‚­ì œ");

        //ğŸ“Œ íƒœê·¸ + í…ìŠ¤íŠ¸
        //<span>3</span>
        noElem.appendChild(noTxt);
        //<span>ìƒ˜í”Œ3</span>
        titleElem.appendChild(titleTxt);
        //<button type="button">ì‚­ì œ</button>
        deleteElem.setAttribute("type", "button");
        titleElem.setAttribute("tabindex", 0); //ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ë¥¼ ìœ„í•œ í¬ì»¤ì‹± (ì ‘ê·¼ì„±)
        deleteElem.appendChild(deleteTxt);

        console.log(deleteElem.type);

        //ğŸ“Œ liì˜ ìì‹ìœ¼ë¡œ ì¶”ê°€ (íƒœê·¸ + í…ìŠ¤íŠ¸)
        //<li><span>3</span></li>
        liElem.appendChild(noElem);
        //<li><span>3</span><span>ìƒ˜í”Œ3</span></li>
        liElem.appendChild(titleElem);
        //<li><span>3</span><span>ìƒ˜í”Œ3</span><button type="button">ì‚­ì œ</button></li>
        liElem.appendChild(deleteElem);

        //ğŸ“Œ custom ì†ì„±
        //<li data-no ="3">
        //elem.dataset.no -> 3
        liElem.dataset.no = item.no;

        //"ì‚­ì œ" ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (ì¶”ê°€ ì´ë²¤íŠ¸ ë°©ë²• (1): DOM Level 2)
        deleteElem.addEventListener("click", function (event) {
          //1ï¸âƒ£ noë¥¼ ì°¾ì•„ì„œ ~~~ ì²«ë²ˆì§¸ ë°©ë²•
          /*  const btn = event.target; //í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œ (<button>)
          //btnì˜ ì¡°ìƒì¤‘ ì…€ë ‰í„°ì™€ ì¼ì¹˜í•˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì¡°ìƒ
          const liNode = btn.closest("li"); // <li data-no="3"> */
          /* deleteItem(liNode.dataset.no); */
          //2ï¸âƒ£noë¥¼ ì°¾ì•„ì„œ ~~~~ë‘ë²ˆì¨° ë°©ë²•
          //TODO í´ë¡œì € ë‹¨ì›ì—ì„œ ì´ìƒí•œ ë¶€ë¶„ í™•ì¸
          //deleteItem(item.no);
        });

        //"ì‚­ì œ" ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬( ì´ë²¤íŠ¸ ë°©ë²• (2) : DOM Level 0)
        deleteElem.setAttribute("onclick", `deleteItem(${item.no})`);

        //ì™„ë£Œ.ë¯¸ì™„ë£Œ ì²˜ë¦¬ ë“±ë¡
        titleElem.setAttribute("onclick", `toggleDone(${item.no})`);

        return liElem;
      }

      // "ì¶”ê°€" ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
      function handleAdd() {
        const inputElem = document.querySelector(".todoinput > input");
        //ë¹ˆ ë¬¸ìê°€ ì•„ë‹ë•Œë§Œ ë‚˜ì˜¤ê²Œ í•¨
        if (inputElem.value.trim() !== "") {
          addItem(inputElem.value); // <input>, <select> ê°™ì€ í¼ ìš”ì†Œì—ëŠ” value ì†ì„±ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì…ë ¥/ ì„ íƒí•œ ê°’ì´ ì €ì¥ë˜ì–´ ìˆìŒ
          //ë¹ˆ ë¬¸ìë¡œ ë˜ëŒë ¤ë†“ê¸°
          inputElem.value = "";
          inputElem.focus();
        }
      }

      //ì—”í„° í‚¤ë¥¼ ëˆŒë €ì„ ë•Œ ì²˜ë¦¬í•  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
      function handlekeyup(event) {
        if (event.key === "Enter") handleAdd();
      }

      //í• ì¼ ì¶”ê°€
      function addItem(title) {
        const todoList = document.querySelector(".todolist");
        const item = {
          //children: ìì‹ë…¸ë“œì˜ ëª©ë¡ (ìš”ì†Œë…¸ë“œ)
          no: todoList.children.length + 1,
          // title: title, //ì†ì„±ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ê°€ ì†ì„±ëª…ê³¼ ì¼ì¹˜í•  ê²½ìš° ì†ì„±ê°’ ìƒëµê°€ëŠ¥
          title,
          done: false, // ë¯¸ì™„ë£Œ ìƒíƒœ
        };

        const todoLi = getTodoItemElem(item);
        console.log(todoLi);

        todoList.appendChild(todoLi);
      }

      //ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬
      function toggleDone(no) {
        console.log(no);
      }

      //í• ì¼ ì‚­ì œ
      function deleteItem(no) {
        const targetLi = document.querySelector(
          `.todolist > li[data-no="${no}"]`
        );
        targetLi.remove();
      }
    </script>
  </body>
</html>
